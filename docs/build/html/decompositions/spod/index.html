

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spectral Proper Orthogonal Decomposition (SPOD) &mdash; MODULO 2.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />

  
      <script src="../../_static/documentation_options.js?v=20623aea"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Read Data" href="../../api/readdata.html" />
    <link rel="prev" title="Kernel Proper Orthogonal Decomposition (KPOD)" href="../kpod/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../intro.html">
            
              <img src="../../_static/modulo_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data pre-processing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../importing_data.html">Importing data and D matrix preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../weights_inner.html">Weighted inner product for non-cartesian meshes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data-Driven Modal Decompositions</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../dft/index.html">Discrete Fourier Transform (DFT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pod/index.html">Proper Orthogonal Decomposition (POD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dmd/index.html">Dynamic Mode Decomposition (DMD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mpod/index.html">Multiscale Proper Orthogonal Decomposition (mPOD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kpod/index.html">Kernel Proper Orthogonal Decomposition (KPOD)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Spectral Proper Orthogonal Decomposition (SPOD)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#theory">Theory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#filtered-covariance-spod-sieber-et-al">Filtered-Covariance SPOD (Sieber et al.)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cross-spectral-density-spod-towne-et-al">Cross-Spectral Density SPOD (Towne et al.)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-in-modulo">Example in MODULO</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/readdata.html">Read Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/dft.html">DFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/pod.html">POD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/mpod.html">mPOD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/dmd.html">DMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/spod.html">SPOD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/kpod.html">kPOD</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/get_code.html">Base contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/testing.html">Development and Testing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Changelog</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../change_log.html">Versions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References &amp; Acknowledgements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../refs_and_ack/refs.html">Useful References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../refs_and_ack/ack.html">Ackowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../intro.html">MODULO</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../intro.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Spectral Proper Orthogonal Decomposition (SPOD)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/decompositions/spod/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spectral-proper-orthogonal-decomposition-spod">
<h1>Spectral Proper Orthogonal Decomposition (SPOD)<a class="headerlink" href="#spectral-proper-orthogonal-decomposition-spod" title="Link to this heading">¶</a></h1>
<p>This document offers a brief reference guide to the use of the Spectral Proper Orthogonal Decomposition (SPOD).</p>
<section id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Link to this heading">¶</a></h2>
<p>The SPOD aims at identifying the coherent modes of a stochastic process at specific frequencies. In the literature,
there are two spectral paths to achieve this result: (1) low-pass filtering the covariance matrix <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>
along the diagonals (<span id="id1">[<a class="reference internal" href="../../refs_and_ack/refs.html#id4" title="Moritz Sieber, C. Oliver Paschereit, and Kilian Oberleithner. Spectral proper orthogonal decomposition. Journal of Fluid Mechanics, 792:798–828, 2016. doi:10.1017/jfm.2016.103.">7</a>]</span>); or (2) by solving an Fredholm eigenvalue problem for
the cross-spectral density matrix at each frequency bin (<span id="id2">[<a class="reference internal" href="../../refs_and_ack/refs.html#id9" title="Aaron Towne, Oliver T. Schmidt, and Tim Colonius. Spectral proper orthogonal decomposition and its relationship to dynamic mode decomposition and resolvent analysis. Journal of Fluid Mechanics, 847:821–867, 2018. doi:10.1017/jfm.2018.283.">8</a>]</span>).</p>
<p>Both options are available in MODULO, and are briefly reviewed below.</p>
<section id="filtered-covariance-spod-sieber-et-al">
<h3>Filtered-Covariance SPOD (Sieber et al.)<a class="headerlink" href="#filtered-covariance-spod-sieber-et-al" title="Link to this heading">¶</a></h3>
<p>The key idea of this approach is to enforce a diagonal similarity of the correlation matrix to get a smoother dynamics.
To this end, the (temporal) correlation matrix <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> is low-pass filtered along the diagonals. This reads:</p>
<div class="math notranslate nohighlight">
\[K_{i, j}^f = \sum_{k=-{N_f}}^{N_f} g_k \; K_{i+k, j+k}\]</div>
<p>where <span class="math notranslate nohighlight">\(g_k\)</span> is a symmetric FIR filter with coefficients of length <span class="math notranslate nohighlight">\(2N_f + 1\)</span>. Once the filtered correlation
matrix <span class="math notranslate nohighlight">\(\mathbf{K}^f\)</span> is botained, the procedure of the SPOD is the same as for the classical POD.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that by default the spatial modes obtained with this procedure <span class="math notranslate nohighlight">\(\mathbf{\Phi}(x)\)</span> are no longer orthogonal.
MODULO rescales them ensuring orthonormality using the standard snapshot approach, via the argument <code class="docutils literal notranslate"><span class="pre">rescale=True</span></code>
in the <code class="docutils literal notranslate"><span class="pre">Spatial_basis_POD</span></code> call.</p>
</div>
</section>
<section id="cross-spectral-density-spod-towne-et-al">
<h3>Cross-Spectral Density SPOD (Towne et al.)<a class="headerlink" href="#cross-spectral-density-spod-towne-et-al" title="Link to this heading">¶</a></h3>
<p>This formulation operates directly in the frequency domain. Thus, to find modes that depends on both space and time,
one needs to define the appropriate inner product. Following the original derivation, this reads:</p>
<div class="math notranslate nohighlight">
\[\langle \mathbf{u}, \mathbf{v} \rangle_{x, t} = \int_{-\infty}^\infty \int_\Omega \mathbf{v}^*(\mathbf{x}, t) \mathbf{u}(\mathbf{x}, t) \; d\mathbf{x}dt.\]</div>
<p>For each frequency <span class="math notranslate nohighlight">\(f\)</span>, we compute the cross‐spectral density by sliding a DFT window over the lags:</p>
<div class="math notranslate nohighlight">
\[S_{i,j}(f)= \sum_{m=-M}^{M}
  K_{\,i+m,\;j+m}\,\exp\bigl(-\,\mathrm{i}2\pi f\,m\Delta t\bigr)\quad\Delta t = 1/F_S.\]</div>
<p>The deterministic functions <span class="math notranslate nohighlight">\(\mathbf{\phi}(\mathbf{x},t)\)</span> are then obtained by solving, at each frequency <span class="math notranslate nohighlight">\(f\)</span>,
the Hermitian Fredholm eigenproblem:</p>
<div class="math notranslate nohighlight">
\[\sum_{j=1}^{n_t}
  S_{i,j}(f)\,\psi_r(t_j;f)
= \lambda_r(f)\,\psi_r(t_i;f),
\quad
\sum_{i=1}^{n_t}\psi_r^*(t_i;f)\psi_s(t_i;f)=\delta_{rs},\]</div>
<p>where <span class="math notranslate nohighlight">\(\psi_r(t_j, f)\)</span> are the temporal SPOD modes and <span class="math notranslate nohighlight">\(\lambda_r(f)\)</span> the corresponding spectral energies.
The spatial SPOD modes <span class="math notranslate nohighlight">\(\phi_r(\mathbf{x};f)\)</span> follow from the snapshot projection of the data onto <span class="math notranslate nohighlight">\(\psi_r\)</span>,
and the full spatio‐temporal structures become</p>
<div class="math notranslate nohighlight">
\[\mathbf{\Phi}_r(\mathbf{x},t;f)
= \phi_r(\mathbf{x};f)\;\exp\!\bigl(\mathrm{i}2\pi f\,t\bigr).\]</div>
</section>
</section>
<section id="example-in-modulo">
<h2>Example in MODULO<a class="headerlink" href="#example-in-modulo" title="Link to this heading">¶</a></h2>
<p>The function <code class="docutils literal notranslate"><span class="pre">SPOD</span></code> of MODULO wraps both approaches, yet the arguments required are different.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Initialize MODULO object</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">ModuloVKI</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
<span class="c1"># Compute the SPOD of Sieber et al.</span>
<span class="n">Phi_S</span><span class="p">,</span> <span class="n">Psi_S</span><span class="p">,</span> <span class="n">Sigma_S</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">SPOD</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;sieber&#39;</span><span class="p">,</span>
                                <span class="n">N_O</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                <span class="n">f_c</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                                <span class="n">n_Modes</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                                <span class="n">SAVE_SPOD</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Compute the SPOD of Towne et al.</span>
<span class="n">Phi_ST</span><span class="p">,</span> <span class="n">Sigma_ST</span><span class="p">,</span> <span class="n">Freqs_PosT</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">SPOD</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;towne&#39;</span><span class="p">,</span>
                                        <span class="n">F_S</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="c1"># sampling frequency</span>
                                        <span class="n">L_B</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="c1"># Length of the chunks for time average</span>
                                        <span class="n">O_B</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="c1"># Overlap between chunks</span>
                                        <span class="n">n_Modes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># number of modes PER FREQUENCY</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>MODULO v. 2.1.0</cite> includes some parallelization capabilities for the CSD SPOD. These take effect in two
steps: (1) when segmenting and computing the FFT on each block of <span class="math notranslate nohighlight">\(\hat{D}(f)\)</span>; and (2) when
computing the POD <cite>n_modes</cite> for each frequency. This enables the user for a direct control over the threads
leveraged in the computation, that otherwise are left up to the numpy vectorization routines.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../kpod/index.html" class="btn btn-neutral float-left" title="Kernel Proper Orthogonal Decomposition (KPOD)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../api/readdata.html" class="btn btn-neutral float-right" title="Read Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 von Karman Institute.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>